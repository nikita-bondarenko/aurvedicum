{"version":3,"file":"js/963.6e0e45e3.js","mappings":"shBAkCA,MAAM,MAAEA,IAAUC,EAAAA,EAAAA,KACZC,GAAOC,EAAAA,EAAAA,IACXC,KAAKC,MAAMC,aAAaC,QAAQ,gBAAkB,CAChDC,QAAS,GACTC,WAAY,GACZC,OAAQ,GACRC,OAAQ,GACRC,YAAa,CACX,CACEC,OAAQ,oBACRC,QAAS,GACTC,GAAI,GAEN,CAAEF,OAAQ,aAAcC,QAAS,GAAIC,GAAI,GACzC,CAAEF,OAAQ,mBAAoBC,QAAS,GAAIC,GAAI,GAC/C,CAAEF,OAAQ,SAAUC,QAAS,GAAIC,GAAI,IAEvCC,SAAU,CAAEC,IAAK,GAAIP,OAAQ,GAAID,WAAY,MAIjDS,EAAAA,EAAAA,WAAiB,cAAehB,EAAKiB,MAAMH,SAASC,MACpDG,EAAAA,EAAAA,KACE,IAAMF,EAAAA,EAAAA,cACLC,IACCjB,EAAKiB,MAAMH,SAASC,IAAME,MAI9BC,EAAAA,EAAAA,KACE,IAAMlB,EAAKiB,QACVA,IACCD,EAAAA,EAAAA,WAAiB,iBAAkBC,EAAMH,SAASN,QAClDQ,EAAAA,EAAAA,WAAiB,qBAAsBC,EAAMH,SAASP,cAExD,CAAEY,MAAM,EAAMC,WAAW,IAG3B,MAAMC,GAAQpB,EAAAA,EAAAA,IAAI,IACZqB,EAAS,KACb,MAAMC,EAAOrB,KAAKC,MAAMC,aAAaC,QAAQ,eAC7CkB,EAAKb,YAAca,EAAKb,YAAYc,QAAQC,GAC1CA,EAAKb,QAAQc,MAAMC,KAAUA,EAAIC,cAE/BL,EAAKb,aACPa,EAAKb,YAAYmB,SAASJ,IACxBA,EAAKb,QAAUa,EAAKb,QAAQY,QAAQC,KAAWA,EAAKG,eAGxD9B,EAAM,OAAQ,eAAgByB,EAAM,eACjCO,MAAK,KACJ1B,aAAa2B,WAAW,cACxBC,EAAAA,EAAAA,KAAY,CAAEC,KAAM,qBAErBC,OAAOC,IACNd,EAAMJ,MAAQkB,EAAIC,SAASpC,KAC3BA,EAAKiB,MAAMP,YAAYmB,SAASJ,IACF,IAAxBA,EAAKb,QAAQyB,SACjBZ,EAAKb,QAAUa,EAAKb,QAAQY,QAAQC,KAAWA,EAAKG,oB,OAK5DV,EAAAA,EAAAA,KACE,IAAMlB,EAAKiB,QACVA,IACCb,aAAakC,QAAQ,aAAcpC,KAAKqC,UAAUtB,MAEpD,CAAEE,MAAM,EAAMC,WAAW,KAG3BoB,EAAAA,EAAAA,KAAgB,IAAMxB,EAAAA,EAAAA,WAAiB,cAAe,M,0fCtGtD,MAAMyB,EAAc,EAEpB","sources":["webpack://client/./src/components/admin/products/AddItem.vue","webpack://client/./src/components/admin/products/AddItem.vue?0d2a"],"sourcesContent":["<template>\r\n  <div class=\"content__top\">\r\n    <ul class=\"breadcrumbs\">\r\n      <li class=\"breadcrumbs__item\">\r\n        <router-link :to=\"{ name: 'adminMenu' }\" class=\"breadcrumbs__link\">\r\n          Меню\r\n        </router-link>\r\n      </li>\r\n      <li class=\"breadcrumbs__item\">\r\n        <router-link :to=\"{ name: 'adminProducts' }\" class=\"breadcrumbs__link\">\r\n          Товары\r\n        </router-link>\r\n      </li>\r\n\r\n      <li class=\"breadcrumbs__item\">\r\n        <span class=\"breadcrumbs__link\" disabled> Добавление товара </span>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n\r\n  <ItemForm\r\n    :text=\"'добавить товар'\"\r\n    v-model:data=\"data\"\r\n    @submit=\"create\"\r\n    :formError=\"error\"\r\n  >\r\n  </ItemForm>\r\n</template>\r\n<script setup>\r\nimport ItemForm from '@/components/admin/products/ItemForm.vue'\r\nimport { ref, watch, onBeforeUnmount } from 'vue'\r\nimport useApi from '@/hooks/useApi'\r\nimport router from '@/router'\r\nimport { store } from '@/store/store'\r\nconst { fetch } = useApi()\r\nconst data = ref(\r\n  JSON.parse(localStorage.getItem('createData')) || {\r\n    volumes: [],\r\n    categories: [],\r\n    brands: [],\r\n    images: [],\r\n    description: [\r\n      {\r\n        header: 'Полезные свойства',\r\n        content: [],\r\n        id: 1\r\n      },\r\n      { header: 'Преминение', content: [], id: 2 },\r\n      { header: 'Противопоказания', content: [], id: 3 },\r\n      { header: 'Состав', content: [], id: 4 }\r\n    ],\r\n    recomend: { ids: [], brands: [], categories: [] }\r\n  }\r\n)\r\n\r\nstore.updateProp('recomendIds', data.value.recomend.ids)\r\nwatch(\r\n  () => store.recomendIds,\r\n  (value) => {\r\n    data.value.recomend.ids = value\r\n  }\r\n)\r\n\r\nwatch(\r\n  () => data.value,\r\n  (value) => {\r\n    store.updateProp('recomendBrands', value.recomend.brands)\r\n    store.updateProp('recomendCategories', value.recomend.categories)\r\n  },\r\n  { deep: true, immediate: true }\r\n)\r\n\r\nconst error = ref({})\r\nconst create = () => {\r\n  const body = JSON.parse(localStorage.getItem('createData'))\r\n  body.description = body.description.filter((item) =>\r\n    item.content.some((obj) => !!obj.paragraph)\r\n  )\r\n  if (body.description) {\r\n    body.description.forEach((item) => {\r\n      item.content = item.content.filter((item) => !!item.paragraph)\r\n    })\r\n  }\r\n  fetch('post', 'api/products', body, 'SaveLoading')\r\n    .then(() => {\r\n      localStorage.removeItem('createData')\r\n      router.push({ name: 'adminProducts' })\r\n    })\r\n    .catch((err) => {\r\n      error.value = err.response.data\r\n      data.value.description.forEach((item) => {\r\n        if (item.content.length === 1) return\r\n        item.content = item.content.filter((item) => !!item.paragraph)\r\n      })\r\n    })\r\n}\r\n\r\nwatch(\r\n  () => data.value,\r\n  (value) => {\r\n    localStorage.setItem('createData', JSON.stringify(value))\r\n  },\r\n  { deep: true, immediate: true }\r\n)\r\n\r\nonBeforeUnmount(() => store.updateProp('recomendIds', []))\r\n</script>\r\n","import script from \"./AddItem.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./AddItem.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["fetch","useApi","data","ref","JSON","parse","localStorage","getItem","volumes","categories","brands","images","description","header","content","id","recomend","ids","store","value","watch","deep","immediate","error","create","body","filter","item","some","obj","paragraph","forEach","then","removeItem","router","name","catch","err","response","length","setItem","stringify","onBeforeUnmount","__exports__"],"sourceRoot":""}