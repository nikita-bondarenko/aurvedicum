{"version":3,"file":"js/145.58ec0861.js","mappings":"miBAmCA,MAAMA,GAAQC,EAAAA,EAAAA,MACRC,GAASC,EAAAA,EAAAA,OACT,MAAEC,IAAUC,EAAAA,EAAAA,KACZC,EAAO,aAAYN,EAAMO,OAAOC,KAChCC,GAAOC,EAAAA,EAAAA,IAAI,IACXC,GAAQD,EAAAA,EAAAA,IAAI,IAElBN,EAAM,MAAOE,EAAK,IAAIM,MAAMC,IAC1BJ,EAAKK,MAAQD,EAAIJ,KACbM,EAAAA,EAAAA,kBACJA,EAAAA,EAAAA,WAAiB,mBAAoBF,EAAIJ,KAAKO,OAAOC,YACrDF,EAAAA,EAAAA,WAAiB,cAAeF,EAAIJ,KAAKO,OAAOE,OAChDH,EAAAA,EAAAA,WAAiB,sBAAuBF,EAAIJ,KAAKO,OAAOG,mBAE1D,MAAMC,EAAO,KACX,MAAMJ,EAASK,OAAOC,OAAO,GAAIb,EAAKK,MAAME,OAAQ,CAClDE,MAAOH,EAAAA,EAAAA,YACPI,cAAeJ,EAAAA,EAAAA,oBACfE,WAAYF,EAAAA,EAAAA,mBAEdX,EAAM,QAASE,EAAKe,OAAOC,OAAO,GAAIb,EAAKK,MAAO,CAAEE,WAAW,gBAC5DJ,MAAK,KACJV,EAAOqB,KAAK,CAAEC,KAAM,mBACpBC,aAAaC,QAAQ,UAAW1B,EAAMO,OAAOC,IAC7CiB,aAAaC,QAAQ,gBAAiB,OAEvCC,OAAOd,GAASF,EAAMG,MAAQD,EAAIe,SAASnB,QAG1CoB,EAAa,KACjBzB,EACE,OACA,uBACAK,EAAKK,MAAME,OACX,iBACAJ,MAAMC,IACNY,aAAaC,QAAQ,gBAAiBb,EAAIJ,MAC1CgB,aAAaC,QAAQ,kBAAmBjB,EAAKK,MAAME,OAAOR,IAC1DN,EAAOqB,KAAK,CAAEC,KAAM,e,gmBCtExB,MAAMM,EAAc,EAEpB","sources":["webpack://client/./src/components/admin/orders/ChangeItem.vue","webpack://client/./src/components/admin/orders/ChangeItem.vue?a832"],"sourcesContent":["<template>\r\n  <div class=\"content__top\">\r\n    <ul class=\"breadcrumbs\">\r\n      <li class=\"breadcrumbs__item\">\r\n        <router-link :to=\"{ name: 'adminMenu' }\" class=\"breadcrumbs__link\">\r\n          Меню\r\n        </router-link>\r\n      </li>\r\n      <li class=\"breadcrumbs__item\">\r\n        <router-link :to=\"{ name: 'adminOrders' }\" class=\"breadcrumbs__link\">\r\n          Заказы\r\n        </router-link>\r\n      </li>\r\n      <li class=\"breadcrumbs__item\">\r\n        <span class=\"breadcrumbs__link\" disabled> Изменение заказа </span>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n  <BaseSpinner v-if=\"store.isLoading\"></BaseSpinner>\r\n  <BaseOrderForm\r\n    v-else\r\n    @submit=\"save\"\r\n    @change=\"changeCart\"\r\n    v-model:data=\"data\"\r\n    :error=\"error\"\r\n    :prime-btn-text=\"'Сохранить изменения'\"\r\n  ></BaseOrderForm>\r\n</template>\r\n<script setup>\r\nimport BaseOrderForm from '@/components/BaseOrderForm.vue'\r\nimport { ref } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { store } from '@/store/store'\r\nimport useApi from '@/hooks/useApi'\r\nimport BaseSpinner from '@/components/small/BaseSpinner.vue'\r\nconst route = useRoute()\r\nconst router = useRouter()\r\nconst { fetch } = useApi()\r\nconst url = `api/order/${route.params.id}`\r\nconst data = ref({})\r\nconst error = ref({})\r\n\r\nfetch('get', url, {}).then((res) => {\r\n  data.value = res.data\r\n  if (store.isOrderedBasket) return\r\n  store.updateProp('basketTotalPrice', res.data.basket.totalPrice)\r\n  store.updateProp('basketItems', res.data.basket.items)\r\n  store.updateProp('basketItemsQuantity', res.data.basket.itemsQuantity)\r\n})\r\nconst save = () => {\r\n  const basket = Object.assign({}, data.value.basket, {\r\n    items: store.basketItems,\r\n    itemsQuantity: store.basketItemsQuantity,\r\n    totalPrice: store.basketTotalPrice\r\n  })\r\n  fetch('patch', url, Object.assign({}, data.value, { basket }), 'OrderLoading')\r\n    .then(() => {\r\n      router.push({ name: 'adminOrderInfo' })\r\n      localStorage.setItem('orderId', route.params.id)\r\n      localStorage.setItem('userAccessKey', '')\r\n    })\r\n    .catch((res) => (error.value = res.response.data))\r\n}\r\n\r\nconst changeCart = () => {\r\n  fetch(\r\n    'post',\r\n    'api/basket/fromOrder',\r\n    data.value.basket,\r\n    'ChangeLoading'\r\n  ).then((res) => {\r\n    localStorage.setItem('userAccessKey', res.data)\r\n    localStorage.setItem('orderedBasketId', data.value.basket.id)\r\n    router.push({ name: 'basket' })\r\n  })\r\n}\r\n</script>\r\n","import script from \"./ChangeItem.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ChangeItem.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["route","useRoute","router","useRouter","fetch","useApi","url","params","id","data","ref","error","then","res","value","store","basket","totalPrice","items","itemsQuantity","save","Object","assign","push","name","localStorage","setItem","catch","response","changeCart","__exports__"],"sourceRoot":""}