"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[105],{105:function(a,e,t){t.r(e),t.d(e,{default:function(){return B}});var l=t(3396),n=t(4870),s=t(4429),i=t(9205),u=t(4920),o=t(4460),c=t(2555),d=t(7139),_=t(9242),r=t(8707);const p={class:"data-base__product admin-product"},m={class:"data-base__name"},v={class:"data-base__created"},b={class:"data-base__changed"},g=(0,l.Uk)("Изменить"),k={class:"data-base__volume volume-block"},h=(0,l.uE)('<li class="volume-block__item"><div class="volume-block__body"><span class="volume-block__header">Объем/вес</span><span class="volume-block__header">Цена</span><span class="volume-block__header">До скидки</span><span class="volume-block__header">Кол-во</span></div></li>',1),f={class:"volume-block__volume"},y={class:"volume-block__price price"},w=["onUpdate:modelValue"],U=(0,l._)("span",{class:"price__currency"},"₽",-1),I={class:"volume-block__ceil ciel"},D=["onUpdate:modelValue"],H={key:0,class:"ceil__currency"},L={class:"volume-block__quantity quantity"},q=["onUpdate:modelValue"],C=["onClick"],S=(0,l._)("svg",{width:"20",height:"20",fill:"currentColor"},[(0,l._)("path",{d:"M17 1L1 17m16 0L1 1",stroke:"#9D9D9D","stroke-width":".8"})],-1),V=[S];var P={__name:"ListItem",props:["id","pagination"],emits:["update:items","update:pagination"],setup(a,{emit:e}){const t=a,{fetch:s,fetchWithParams:i}=(0,u.Z)(),c=`api/products/${t.id}`,S=(0,r.Z)(),P=(0,n.iH)({}),W=a=>{P.value=a.data},Z=async(a,{func:e},t="ItemLoading",l={})=>{s(a,c,l,t).then((a=>e(a)))};Z("get",{func:W});const j=setInterval((()=>Z("get",{func:W},"")),1e3);(0,l.Jd)((()=>{clearInterval(j)}));const z=()=>{i("delete",c,t.pagination,"ItemLoading").then((a=>{e("update:pagination",a.data.pagination),e("update:items",a.data.items),clearInterval(j)}))},Y=((0,n.iH)(null),(0,n.iH)(null)),$=()=>{s("patch",`api/products/${t.id}`,{volumes:P.value.volumes},`${t.id}Updating`)},x=(0,n.Vh)(o.h,`is${t.id}Updating`);return(e,t)=>{const s=(0,l.up)("router-link");return(0,l.wg)(),(0,l.iD)("li",{class:(0,d.C_)(["data-base__item",{"spinner-small":(0,n.SU)(o.h).isItemLoading||(0,n.SU)(x),"loading-error":(0,n.SU)(o.h).isItemLoadingFailed}])},[(0,l._)("div",p,[(0,l._)("h3",m,(0,d.zw)(P.value.name),1),(0,l._)("span",v,"Создан: "+(0,d.zw)((0,n.SU)(S).editDate(P.value.created)),1),(0,l._)("span",b,"Изменен: "+(0,d.zw)((0,n.SU)(S).editDate(P.value.changed)),1),(0,l.Wm)(s,{class:"data-base__change-button",to:{name:"adminChangeProduct",params:{id:a.id}}},{default:(0,l.w5)((()=>[g])),_:1},8,["to"]),(0,l._)("ul",k,[h,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(P.value.volumes,(a=>((0,l.wg)(),(0,l.iD)("li",{key:a.id,class:"volume-block__item"},[(0,l._)("div",{class:(0,d.C_)(["volume-block__body",{"volume-block__body--three-items":!a.subprice}])},[(0,l._)("span",f,(0,d.zw)((0,n.SU)(S).editVolumeFormat(a.volume)),1),(0,l._)("div",y,[(0,l.wy)((0,l._)("input",{ref_for:!0,ref_key:"priceInput",ref:Y,onInput:$,type:"text",class:"price__input","onUpdate:modelValue":e=>a.price=e},null,40,w),[[_.nr,a.price,void 0,{number:!0}]]),U]),(0,l._)("div",I,[(0,l.wy)((0,l._)("input",{ref_for:!0,ref_key:"priceInput",ref:Y,onInput:$,type:"text",class:"ceil__input","onUpdate:modelValue":e=>a.subprice=e},null,40,D),[[_.nr,a.subprice,void 0,{number:!0}]]),a.subprice?((0,l.wg)(),(0,l.iD)("span",H,"₽")):(0,l.kq)("",!0)]),(0,l._)("div",L,[(0,l.wy)((0,l._)("input",{onInput:$,type:"text",class:"quantity__input","onUpdate:modelValue":e=>a.quantity=e},null,40,q),[[_.nr,a.quantity,void 0,{number:!0}]])])],2)])))),128))]),(0,l._)("button",{class:"data-base__button-del button-del",type:"button","aria-label":"Удалить товар",onClick:(0,_.iM)(z,["prevent"])},V,8,C)])],2)}}};const W=P;var Z=W;const j={class:"content__top"},z={class:"breadcrumbs"},Y={class:"breadcrumbs__item"},$=(0,l.Uk)(" Меню "),x=(0,l._)("li",{class:"breadcrumbs__item"},[(0,l._)("span",{class:"breadcrumbs__link",disabled:""}," Товары ")],-1),M={class:"content__catalog data-base"},F={class:"settings"},K={class:"catalog"},A=(0,l.Uk)("Добавить"),E={class:"data-base__list"};var J={__name:"ListPage",setup(a){const{fetchWithParams:e}=(0,u.Z)(),t=(0,n.iH)({page:1,limit:6}),d=(0,n.iH)([]),_=(0,n.iH)({}),r=(a={})=>{e("get","api/products",Object.assign({},t.value,a)).then((a=>{d.value=a.data.items,_.value=a.data.pagination}))};return(0,l.YP)((()=>t.value),(()=>r()),{deep:!0}),r(),(a,e)=>{const u=(0,l.up)("router-link");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",j,[(0,l._)("ul",z,[(0,l._)("li",Y,[(0,l.Wm)(u,{to:{name:"adminMenu"},class:"breadcrumbs__link"},{default:(0,l.w5)((()=>[$])),_:1})]),x])]),(0,l._)("div",M,[(0,l._)("div",F,[(0,l.Wm)(s.Z,{onSubmit:e[0]||(e[0]=a=>r()),settings:t.value,"onUpdate:settings":e[1]||(e[1]=a=>t.value=a)},null,8,["settings"])]),(0,l._)("section",K,[(0,l.Wm)(u,{to:{name:"adminAddProduct"},class:"data-base__button-add"},{default:(0,l.w5)((()=>[A])),_:1}),(0,n.SU)(o.h).isLoading?((0,l.wg)(),(0,l.j4)(i.Z,{key:0})):(0,l.kq)("",!0),(0,l._)("ul",E,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.value,(a=>((0,l.wg)(),(0,l.j4)(Z,{key:a.id,id:a.id,items:d.value,"onUpdate:items":e[2]||(e[2]=a=>d.value=a),pagination:_.value,"onUpdate:pagination":e[3]||(e[3]=a=>_.value=a)},null,8,["id","items","pagination"])))),128))]),_.value.pages>1?((0,l.wg)(),(0,l.j4)(c.Z,{key:1,class:"catalog__pagination",config:t.value,"onUpdate:config":e[4]||(e[4]=a=>t.value=a),pagination:_.value},null,8,["config","pagination"])):(0,l.kq)("",!0)])])],64)}}};const O=J;var B=O}}]);
//# sourceMappingURL=105.ca8d78b6.js.map