"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[568],{568:function(e,t,a){a.r(t),a.d(t,{default:function(){return _e}});var s=a(3396),l=a(4870),i=a(7007),n=a(9829),o=a(4920),r=a(4460),d=a(2555),u=a(7139),c=a(9242),_=a(8707);const p={version:"1.1",id:"Capa_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"30.021px",height:"30.021px",viewBox:"0 0 30.021 30.021",style:{"enable-background":"new 0 0 30.021 30.021"},"xml:space":"preserve"},m=(0,s._)("g",null,[(0,s._)("path",{d:"M29.069,22.276c-0.791,0.932-1.917,1.409-3.052,1.409c-0.913,0-1.834-0.312-2.587-0.949l-8.42-7.152l-8.42,7.151\r\n  c-1.683,1.43-4.208,1.225-5.639-0.459c-1.43-1.686-1.224-4.208,0.46-5.64l11.01-9.351c1.493-1.269,3.686-1.269,5.178,0\r\n  l11.011,9.351C30.294,18.068,30.499,20.591,29.069,22.276z"})],-1),v=[m],g={ref:"dropBox",class:"drop-box"},b={class:"drop-box__body"},w={class:"drop-box__list"},h=["onClick"];function f(e,t,a,l,i,n){return(0,s.wg)(),(0,s.iD)("div",{class:(0,u.C_)(["select volume-row__item",{"select--open":e.isSelectOpen}]),ref:"selectElement",onMouseenter:t[0]||(t[0]=t=>e.isSelectHover=!0),onMouseleave:t[1]||(t[1]=t=>e.isSelectHover=!1),onClick:t[2]||(t[2]=(0,c.iM)((t=>e.isSelectOpen=!e.isSelectOpen),["prevent"]))},[(0,s.Uk)((0,u.zw)(e.item.title||"")+" ",1),(0,s._)("div",{class:(0,u.C_)(["select-arrow",{"select-arrow--hover":e.isSelectHover,"select-arrow--open":e.isSelectOpen}])},[((0,s.wg)(),(0,s.iD)("svg",p,v))],2),(0,s._)("div",g,[(0,s._)("div",b,[(0,s._)("ul",w,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.items,(t=>(0,s.wy)(((0,s.wg)(),(0,s.iD)("li",{class:"drop-box__item",key:t.id},[(0,s._)("button",{onClick:(0,c.iM)((a=>e.select(t)),["prevent"]),class:"drop-box__button"},(0,u.zw)(t.title||""),9,h)])),[[c.F8,t.id!==e.item.id]]))),128))])])],512)],34)}var k=(0,s.aZ)({props:["items","item"],emits:["update:item","submit"],setup(e,{emit:t}){const a=(0,l.iH)(!1),i=(0,l.iH)(!1),n=(0,l.iH)(null),o=(0,l.iH)(null),{editVolumeFormat:r}=(0,_.Z)();(0,s.YP)((()=>i.value),(e=>{e?o.value.classList.add("drop-box--open"):(o.value.classList.add("drop-box--hidden"),o.value.classList.remove("drop-box--open"),setTimeout((()=>o.value.classList.remove("drop-box--hidden")),500))})),document.body.addEventListener("click",(()=>!a.value&&i.value?i.value=!1:1));const d=e=>{t("update:item",e),t("submit")};return{select:d,editVolumeFormat:r,isSelectHover:a,isSelectOpen:i,selectElement:n,dropBox:o}}}),D=a(89);const H=(0,D.Z)(k,[["render",f]]);var x=H;const y={class:"order__body"},B={class:"order__name data-base__name"},S={class:"order__phone"},U={class:"order__address"},C={class:"order__created data-base__created"},L={class:"order__changed data-base__changed"},Z=(0,s.Uk)("Изменить"),V=["onClick"],z=(0,s._)("svg",{width:"20",height:"20",fill:"currentColor"},[(0,s._)("path",{d:"M17 1L1 17m16 0L1 1",stroke:"#9D9D9D","stroke-width":".8"})],-1),I=[z];var M={__name:"ListItem",props:["id","pagination"],emits:["update:items","update:pagination"],setup(e,{emit:t}){const a=e,{fetch:i,fetchWithParams:n}=(0,o.Z)(),d=(0,_.Z)(),p=`api/order/${a.id}`,m=(0,l.iH)({}),v=(0,l.iH)([]),g=(0,l.iH)({}),b=()=>{i("patch",p,{status:g.value},"")};i("get","api/status").then((e=>{v.value=e.data.items})),i("get",p,{},"ItemLoading").then((e=>{m.value=e.data,g.value=e.data.status}));const w=setInterval((()=>{i("get",p,{},"").then((e=>{m.value=e.data}))}),1e3);(0,s.Jd)((()=>{clearInterval(w)}));const h=()=>{n("delete",p,a.pagination,"ItemLoading").then((e=>{t("update:pagination",e.data.pagination),t("update:items",e.data.items),clearInterval(w)}))};return(t,a)=>{const i=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("li",{class:(0,u.C_)(["data-base__item",{"spinner-small":(0,l.SU)(r.h).isItemLoading}])},[(0,s._)("div",y,[(0,s._)("h3",B,(0,u.zw)(m.value.name),1),(0,s._)("span",S,(0,u.zw)(m.value.phone),1),(0,s._)("span",U,(0,u.zw)(m.value.address),1),(0,s.Wm)(x,{class:"order__select",items:v.value,item:g.value,"onUpdate:item":a[0]||(a[0]=e=>g.value=e),onSubmit:b},null,8,["items","item"]),(0,s._)("span",C,"Создан: "+(0,u.zw)((0,l.SU)(d).editDate(m.value.created)),1),(0,s._)("span",L,"Изменен: "+(0,u.zw)((0,l.SU)(d).editDate(m.value.changed)),1),(0,s.Wm)(i,{class:"order__change-button data-base__change-button",to:{name:"adminChangeOrder",params:{id:e.id}}},{default:(0,s.w5)((()=>[Z])),_:1},8,["to"]),(0,s._)("button",{class:"data-base__button-del button-del order__button-del",type:"button","aria-label":"Удалить товар",onClick:(0,c.iM)(h,["prevent"])},I,8,V)])],2)}}};const P=M;var F=P;const O={class:"filter"},W={class:"form__block"},Y=(0,s._)("legend",{class:"form__legend"},"Дата создания",-1),T={for:"low",class:"form__label form__label--date"},j=(0,s._)("span",{class:"form__value"},"От",-1),q={for:"high",class:"form__label form__label--date"},E=(0,s._)("span",{class:"form__value"},"До",-1),K={class:"form__block"},R=(0,s._)("legend",{class:"form__legend"},"Статус доставки",-1),$={class:"form__label"};function J(e,t,a,l,i,n){const o=(0,s.up)("BaseSelect");return(0,s.wg)(),(0,s.iD)("aside",O,[(0,s._)("button",{onClick:t[0]||(t[0]=(...t)=>e.openFilter&&e.openFilter(...t)),type:"button",class:"button button--second filter__button-wrapper"},(0,u.zw)(e.isFilter?"Скрыть фильтр":"Открыть фильтр"),1),(0,s._)("div",{class:(0,u.C_)(["filter__wrapper",{"filter__wrapper--open":e.isFilter}]),ref:"wrapper"},[(0,s._)("form",{onSubmit:t[5]||(t[5]=(0,c.iM)((t=>e.$emit("submit")),["prevent"])),class:"filter__form form",action:"#",method:"get"},[(0,s._)("fieldset",W,[Y,(0,s._)("label",T,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.config.lowBorder=t),class:"form__input filter__date",type:"date",placeholder:"Введите число"},null,512),[[c.nr,e.config.lowBorder]]),j]),(0,s._)("label",q,[(0,s.wy)((0,s._)("input",{placeholder:"Введите число","onUpdate:modelValue":t[2]||(t[2]=t=>e.config.highBorder=t),class:"form__input filter__date",type:"date"},null,512),[[c.nr,e.config.highBorder]]),E])]),(0,s._)("fieldset",K,[R,(0,s._)("label",$,[(0,s.Wm)(o,{style:{"z-index":"10000"},items:e.statuses,placeholder:"Все категории",modelValue:e.config.statusId,"onUpdate:modelValue":t[3]||(t[3]=t=>e.config.statusId=t)},null,8,["items","modelValue"])])]),e.isReset?((0,s.wg)(),(0,s.iD)("button",{key:0,onClick:t[4]||(t[4]=(0,c.iM)(((...t)=>e.reset&&e.reset(...t)),["prevent"])),class:"filter__reset button button--second",type:"button"}," Сбросить ")):(0,s.kq)("",!0)],32)],2)])}var A=a(3088),G=(0,s.aZ)({emits:["submit","update:settings"],props:["settings"],setup(e,{emit:t}){const a=(0,l.iH)(null),{fetch:i}=(0,o.Z)(),n=(0,l.iH)({...e.settings}),r=(0,l.iH)(!1),d=(0,l.iH)(!1),u=(0,l.iH)(!1),c=(0,l.iH)([]);i("get","api/status").then((e=>{c.value=e.data.items})),(0,s.YP)((()=>n.value),(e=>{r.value=Object.entries(e).some((([e,t])=>!("limit"===e||"page"===e||!t))),u.value=!1,e.lowBorder&&e.highBorder&&(u.value=Date.parse(new Date(e.lowBorder+"T00:00:00"))>Date.parse(new Date(e.highBorder+"T23:59:59"))),t("update:settings",e)}),{deep:!0});const _=()=>{n.value={limit:e.settings.limit,page:e.settings.page}},p=(0,l.iH)(null),m=()=>{d.value=!d.value};return(0,s.YP)((()=>d.value),(e=>{e?setTimeout((()=>p.value.classList.add("filter__wrapper--open_overflow")),1e3):p.value.classList.remove("filter__wrapper--open_overflow")})),{statuses:c,wrapper:p,openFilter:m,reset:_,isFilter:d,isDateError:u,isReset:r,config:n,searchValue:a}},components:{OrderSelect:x,BaseSelect:A.Z}});const N=(0,D.Z)(G,[["render",J]]);var Q=N;const X={class:"content__top"},ee={class:"breadcrumbs"},te={class:"breadcrumbs__item"},ae=(0,s.Uk)(" Меню "),se=(0,s._)("li",{class:"breadcrumbs__item"},[(0,s._)("span",{class:"breadcrumbs__link",disabled:""}," Заказы ")],-1),le={class:"content__catalog order data-base"},ie={class:"settings"},ne={class:"catalog"},oe=(0,s.Uk)(" Добавить заказ"),re={key:1,class:"data-base__empty-message"},de={class:"data-base__list order__list"};var ue={__name:"ListPage",setup(e){const{fetchWithParams:t}=(0,o.Z)(),a=(0,l.iH)({page:1,limit:6}),u=(0,l.iH)([]),c=(0,l.iH)({}),_=(e={})=>{t("get","api/order",Object.assign({},a.value,e)).then((e=>{u.value=e.data.items,c.value=e.data.pagination}))};return(0,s.YP)((()=>a.value),(()=>_()),{deep:!0}),(0,s.YP)((()=>a.value),(e=>{e.status&&(a.value.statusId=e.status.id),e.lowBorder&&(a.value.lowBorderParse=Date.parse(new Date(e.lowBorder+"T00:00:00"))),e.highBorder&&(a.value.highBorderParse=Date.parse(new Date(e.highBorder+"T23:59:59")))}),{deep:!0}),_(),(e,t)=>{const o=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",X,[(0,s._)("ul",ee,[(0,s._)("li",te,[(0,s.Wm)(o,{to:{name:"adminMenu"},class:"breadcrumbs__link"},{default:(0,s.w5)((()=>[ae])),_:1})]),se])]),(0,s._)("div",le,[(0,s._)("div",ie,[(0,s.Wm)(i.Z,{modelValue:a.value.name,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value.name=e)},null,8,["modelValue"]),(0,s.Wm)(Q,{settings:a.value,"onUpdate:settings":t[1]||(t[1]=e=>a.value=e)},null,8,["settings"])]),(0,s._)("section",ne,[(0,s.Wm)(o,{to:{name:"order"},class:"data-base__button-add"},{default:(0,s.w5)((()=>[oe])),_:1}),(0,l.SU)(r.h).isLoading?((0,s.wg)(),(0,s.j4)(n.Z,{key:0})):(0,s.kq)("",!0),0!==u.value.length||(0,l.SU)(r.h).isLoading?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("p",re," Список пуст ")),(0,s._)("ul",de,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(u.value,(e=>((0,s.wg)(),(0,s.j4)(F,{key:e.id,id:e.id,items:u.value,"onUpdate:items":t[2]||(t[2]=e=>u.value=e),pagination:c.value,"onUpdate:pagination":t[3]||(t[3]=e=>c.value=e)},null,8,["id","items","pagination"])))),128))]),c.value.pages>1?((0,s.wg)(),(0,s.j4)(d.Z,{key:2,class:"catalog__pagination",config:a.value,"onUpdate:config":t[4]||(t[4]=e=>a.value=e),pagination:c.value},null,8,["config","pagination"])):(0,s.kq)("",!0)])])],64)}}};const ce=ue;var _e=ce}}]);
//# sourceMappingURL=568.ee1d17eb.js.map