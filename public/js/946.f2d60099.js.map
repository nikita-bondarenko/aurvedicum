{"version":3,"file":"js/946.f2d60099.js","mappings":"qzBA0DA,MAAMA,GAAQC,EAAAA,EAAAA,MACRC,GAASC,EAAAA,EAAAA,OACT,MAAEC,IAAUC,EAAAA,EAAAA,KACZC,GAAOC,EAAAA,EAAAA,IACXC,aAAaC,QAAQ,aACjBC,KAAKC,MAAMH,aAAaC,QAAQ,cAChC,CAAEG,SAAU,GAAIC,cAAe,IAE/BC,GAAQP,EAAAA,EAAAA,IAAI,KAClBQ,EAAAA,EAAAA,KACE,IAAMT,EAAKU,QACX,KACER,aAAaS,QAAQ,YAAaP,KAAKQ,UAAUZ,EAAKU,UAExD,CAAEG,MAAM,IAGV,MAAMC,EAAO,KACX,MAAMC,EAASC,OAAOC,OAAO,GAAIjB,EAAKU,MAAMK,OAAQ,CAClDG,MAAOC,EAAAA,EAAAA,YACPC,cAAeD,EAAAA,EAAAA,oBACfE,WAAYF,EAAAA,EAAAA,mBAEdrB,EACE,OACA,YACAkB,OAAOC,OACL,GACAjB,EAAKU,MACL,CAAEK,UACF,CAAEO,SAAUpB,aAAaC,QAAQ,mBAEnC,gBAECoB,MAAMC,IACLtB,aAAaS,QAAQ,UAAWa,EAAIxB,KAAKyB,SACzCvB,aAAaS,QAAQ,gBAAiB,IAEtCf,EAAO8B,KAAK,CAAEC,KAAM,iBAErBC,OAAOJ,GAAShB,EAAME,MAAQc,EAAIK,SAAS7B,QAG1C8B,EAAa,KACjBlC,EAAO8B,KAAK,CAAEC,KAAM,Y,+7BCnGtB,MAAMI,EAAc,EAEpB","sources":["webpack://client/./src/views/OrderPage.vue","webpack://client/./src/views/OrderPage.vue?f1d6"],"sourcesContent":["<template>\r\n  <div class=\"container content\">\r\n    <div class=\"content__top\">\r\n      <ul v-if=\"route.name === 'adminOrderAdd'\" class=\"breadcrumbs\">\r\n        <li class=\"breadcrumbs__item\">\r\n          <router-link :to=\"{ name: 'adminMenu' }\" class=\"breadcrumbs__link\">\r\n            Меню\r\n          </router-link>\r\n        </li>\r\n        <li class=\"breadcrumbs__item\">\r\n          <router-link :to=\"{ name: 'adminOrders' }\" class=\"breadcrumbs__link\">\r\n            Заказы\r\n          </router-link>\r\n        </li>\r\n        <li class=\"breadcrumbs__item\">\r\n          <span class=\"breadcrumbs__link\"> Оформление заказа </span>\r\n        </li>\r\n      </ul>\r\n\r\n      <ul v-else class=\"breadcrumbs\">\r\n        <li class=\"breadcrumbs__item\">\r\n          <router-link\r\n            @click=\"store.setCatalogPathName\"\r\n            class=\"breadcrumbs__link\"\r\n            :to=\"{ name: 'catalog' }\"\r\n          >\r\n            Каталог\r\n          </router-link>\r\n        </li>\r\n        <li class=\"breadcrumbs__item\">\r\n          <router-link class=\"breadcrumbs__link\" :to=\"{ name: 'basket' }\">\r\n            Корзина\r\n          </router-link>\r\n        </li>\r\n        <li class=\"breadcrumbs__item\">\r\n          <a class=\"breadcrumbs__link\"> Оформление заказа </a>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n\r\n    <BaseSpinner v-if=\"store.isLoading\"></BaseSpinner>\r\n    <BaseOrderForm\r\n      v-else\r\n      @submit=\"save\"\r\n      @change=\"changeCart\"\r\n      v-model:data=\"data\"\r\n      :error=\"error\"\r\n      :prime-btn-text=\"'Оформить заказ'\"\r\n    ></BaseOrderForm>\r\n  </div>\r\n</template>\r\n<script setup>\r\nimport BaseOrderForm from '@/components/BaseOrderForm.vue'\r\nimport { ref, watch } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { store } from '@/store/store'\r\nimport useApi from '@/hooks/useApi'\r\nimport BaseSpinner from '@/components/small/BaseSpinner.vue'\r\nconst route = useRoute()\r\nconst router = useRouter()\r\nconst { fetch } = useApi()\r\nconst data = ref(\r\n  localStorage.getItem('orderData')\r\n    ? JSON.parse(localStorage.getItem('orderData'))\r\n    : { delivery: {}, deliveryPrice: 0 }\r\n)\r\nconst error = ref({})\r\nwatch(\r\n  () => data.value,\r\n  () => {\r\n    localStorage.setItem('orderData', JSON.stringify(data.value))\r\n  },\r\n  { deep: true }\r\n)\r\n\r\nconst save = () => {\r\n  const basket = Object.assign({}, data.value.basket, {\r\n    items: store.basketItems,\r\n    itemsQuantity: store.basketItemsQuantity,\r\n    totalPrice: store.basketTotalPrice\r\n  })\r\n  fetch(\r\n    'post',\r\n    'api/order',\r\n    Object.assign(\r\n      {},\r\n      data.value,\r\n      { basket },\r\n      { basketId: localStorage.getItem('userAccessKey') }\r\n    ),\r\n    'OrderLoading'\r\n  )\r\n    .then((res) => {\r\n      localStorage.setItem('orderId', res.data.orderId)\r\n      localStorage.setItem('userAccessKey', '')\r\n\r\n      router.push({ name: 'orderInfo' })\r\n    })\r\n    .catch((res) => (error.value = res.response.data))\r\n}\r\n\r\nconst changeCart = () => {\r\n  router.push({ name: 'basket' })\r\n}\r\n</script>\r\n","import script from \"./OrderPage.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./OrderPage.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["route","useRoute","router","useRouter","fetch","useApi","data","ref","localStorage","getItem","JSON","parse","delivery","deliveryPrice","error","watch","value","setItem","stringify","deep","save","basket","Object","assign","items","store","itemsQuantity","totalPrice","basketId","then","res","orderId","push","name","catch","response","changeCart","__exports__"],"sourceRoot":""}